Процедура ОбработкаПроведения(Отказ, Режим)

	Для Каждого Стр Из Работы Цикл

		// Выполненные работы
		ДвижРабот = Движения.ВыполненныеРаботы.Добавить();
		ДвижРабот.Период = Дата;
		ДвижРабот.Сотрудник = Стр.Сотрудник;
		ДвижРабот.ВидРаботы = Стр.ВидРаботы;
		ДвижРабот.Заявка = Заявка;
		ДвижРабот.Сумма = Стр.Сумма;
		ДвижРабот.Количество = 1;

		// Затраты на ремонт
		ДвижЗатрат = Движения.ЗатратыНаРемонт.Добавить();
		ДвижЗатрат.Период = Дата;
		ДвижЗатрат.Заявка = Заявка;
		ДвижЗатрат.Сумма = Стр.Сумма;
		ДвижЗатрат.ВидЗатраты = Перечисления.ВидЗатраты.Работы;

		// Загрузка сотрудников
		ДвижЗагрузка = Движения.ЗагрузкаСотрудников.Добавить();
		ДвижЗагрузка.Период = Дата;
		ДвижЗагрузка.Сотрудник = Стр.Сотрудник;
		ДвижЗагрузка.Заявка = Заявка;
		ДвижЗагрузка.Время = Стр.Время;

		// История обслуживания
		Набор = РегистрыСведений.ИсторияОбслуживания.ОткрытьНаборЗаписей();
		Запись = Набор.Добавить();
		Запись.Оборудование = Стр.Оборудование;
		Запись.ВидРабот = Стр.ВидРаботы;
		Запись.Сотрудник = Стр.Сотрудник;
		Запись.Заявка = Заявка;
		Запись.ДатаОбслуживания = Дата;
		Набор.Записать();

	КонецЦикла;

КонецПроцедуры
